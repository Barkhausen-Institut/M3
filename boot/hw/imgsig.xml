<config>
    <kernel args="kernel -f $fs.path" />
    <dom>
        <app args="root">
            <dom>
                <app args="m3fs mem $fs.size" daemon="1">
                    <serv name="m3fs" />
                    <physmem addr="0" size="$fs.size" />
                </app>
            </dom>
            <dom>
                <app args="pager maxcli=4 sem=net $fs.size" usermem="768M">
                    <sess name="m3fs" />
                    <physmem addr="0" size="$fs.size" perm="r" />
                    <pes name="child" type="core" count="4" />
                    <dom>
                        <app args="/bin/net net0 127.0.0.1" daemon="1">
                            <serv name="net0" />
                            <pes name="nic" type="nic" />
                        </app>
                    </dom>
                    <dom>
                        <app args="/bin/net net1 127.0.0.2" daemon="1">
                            <serv name="net1" />
                            <pes name="nic" type="nic" />
                        </app>
                    </dom>
                    <dom>
                        <app args="/bin/imgrcv 1337" daemon="1">
                            <sess lname="net" gname="net0" args="bufs=1M socks=1 ports=1337" />
                        </app>
                    </dom>
                    <dom>
                        <app args="/bin/imgsnd 127.0.0.1 1337 /testcase1.wav">
                            <mount fs="m3fs" path="/" />
                            <sess lname="net" gname="net1" args="bufs=1M socks=1" />
                        </app>
                    </dom>
                </app>
            </dom>
        </app>
    </dom>
</config>
