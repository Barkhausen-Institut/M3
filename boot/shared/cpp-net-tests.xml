<config>
    <kernel args="kernel -b net0-net1 -f $fs.path" />
    <app args="root sharepe">
        <dom>
            <app args="m3fs mem $fs.size" daemon="1">
                <serv name="m3fs" />
                <physmem addr="0" size="$fs.size" />
            </app>
        </dom>
        <dom>
            <app args="netrs net0 192.168.112.2 255.255.255.0" daemon="1">
                <serv name="net0" />
                <pes type="nic" />
            </app>
        </dom>
        <dom>
            <app args="netrs net1 192.168.112.1 255.255.255.0" daemon="1">
                <serv name="net1" />
                <pes type="nic" />
            </app>
        </dom>
        <dom>
            <app args="pager $fs.size sem=net-udp sem=net-tcp sharepe">
                <sess name="m3fs" />
                <physmem addr="0" size="$fs.size" perm="r" />
                <pes type="core" count="2" />
                <dom>
                    <app args="/bin/netechoserver" daemon="1">
                        <sess name="net1" args="bufs=256K socks=2 ports=1337,1338" />
                        <sem name="net-udp" />
                        <sem name="net-tcp" />
                    </app>
                </dom>
                <dom>
                    <app args="/bin/cppnettests">
                        <sess name="net0" args="bufs=64K socks=2 ports=2000-2001" />
                        <sess name="net1" args="bufs=64K socks=2 ports=3000" />
                        <pes type="core" count="1" />
                        <sem name="net-udp" />
                        <sem name="net-tcp" />
                    </app>
                </dom>
            </app>
        </dom>
    </app>
</config>
